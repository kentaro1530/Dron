\subsection{Procedure of template fitting}
\input{discussion/template_fitting/figs/fit_IM}
\input{discussion/template_fitting/figs/fit_KNpi_MM_all}

In this subsection, we explain procedure of template fitting, whose main purpose is decomposition of $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ modes.
Template fitting is divided into two stages, one fitting to estimate the amount of background for $K^0$ and $\Sigma_{forward}$ production,
the other to separate $\pi^-\Sigma^+$ and $\pi^+\Sigma^-$ modes.
These fittings are performed using fitting with the likelihood method on a finite sample generated by Monte Carlo method\cite{temp_fit}.
There is no $\chi^2$ in this fitting,
but there is a value of $-2\log\Lambda$ that asymptotically approaches the $\chi^2$ when the number of samples become infinite, and the fitting is evaluated with this value.
Here, $\Lambda$ is the likelihood.

The first fitting is performed using the invariant mass distributions of $\pi^+ \pi^-$, $n \pi^+$ and $n \pi^-$ in the event that $K^-d \rightarrow n \pi^+ \pi^- n$ final state.
The $K^0$, $\Sigma^+$ and $\Sigma^-$ productions create peaks in the respective invariant mass distributions as shown in Fig.\ref{fig:fit_IM}.
The distributions reconstructed by fitting are also plotted in the same figure.
The bold line represents the case of backward $\pi \Sigma$ production of signal, with red and blue representing the $\pi^- \Sigma^+$ and $\pi^-\Sigma^+$ modes, respectively.
The other green, purple and orange lines represent the background for $K^0$, $\Sigma^-_{forward}$ and $\Sigma^+_{forward}$ production, respectively.
This fitting of $-2\log\Lambda$ is \IMfitChiSquare.
Degrees freedom is the number of bin with data, and $-2\log\Lambda/NDF \sim $\IMfitChiNDF. 
% For this purpose, the distribution is fitted with a Gaussian and a 5-th polynomial function, and the rejection region is defined by the 3$\sigma$ of the Gaussian.

\input{discussion/template_fitting/figs/fit_KNpi_MM}
\input{discussion/template_fitting/figs/tempFit_KNpi_Chi2}

The fitting to separate the $\pi^-\Sigma^+$ and $\pi^+\Sigma^-$ modes is performed for events from $K^-- d \rightarrow n \pi^+ \pi- n$, excluding $K^0 $and $\Sigma^{\pm}_{forward}$ production.
However, the background leakage is estimated by scaling the distribution reconstructed in the MC simulation by the intensity estimated by the invariant mass fitting.
This fitting is performed each bin of the missing mass of $d(K^-, n)$, since the scattering amplitude of $\bar{K}N \rightarrow \pi \Sigma$ depends on the $\pi \Sigma$ invariant mass.
For this fitting we use the $d(K^-, n \pi^-)$ and $d(K^-, n \pi^+)$ missing masses as shown in Fig.\ref{fig:fit_KNpi_MM_all}.
This figure shows the sum of the $d(K^- , n)$ bins.
The bottom left figure shows a two-dimensional figure of the $d(K^-, n \pi^-)$ and $d(K^-, n \pi^+)$ missing masses on the horizontal and vertical axes, respectively.
The top and right figures show the projections of the respective axes.
The missing mass of $d(K^-, n \pi)$ makes a peak at $\Sigma$ for the correct combination for the missing $\Sigma$, but is widely distributed in the kinematic region for the opposite charge.
For example, for $d(K^-, n \pi^-)$, the $\pi^- \Sigma^+$ mode has a peak structure as shown by the red line,
whereas the $\pi^+ \Sigma^-$ mode has a widely distributed structure as shown by the blue line.

Fig.\ref{fig:fit_KNpi_MM} shows the results for the fitting of each bin of $d(K^-, n)$ separately.
Fig.\ref{fig:tempFit_KNpi_Chi2} shows the $-2\log\Lambda$ and $-2\log\Lambda/NDF$ of this fitting in each $d(K^-, n)$ bin in black and red, respectively.

Fitting to estimate background and to separate $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ modes cannot be performed simultaneously as they use different event samples.
They are therefore repeated in the following steps.

First, the separation of $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ modes is performed without considering the background.
The obtained distribution of backward $\pi^{\mp} \Sigma^{\pm}$ modes is used for fitting to estimate the background,
which is then fed back into the fitting of the separation of $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ modes.
After five iterations of this procedure, fitting is performed considering 2-step and direct $\Lambda(1520)$ generation for $K^0$ generation, which is described in the next subsection.
Finally, fitting of the separation of the $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ modes is performed to obtain the final $\pi \Sigma$ spectrum as shown in Fig.\ref{fig:piS_num}..

\input{discussion/template_fitting/figs/piS_num}

%% The latter fitting must be done for each bin of

%% of event that rejected the $K^0$ and $\Sigma_{forward}$ from the $K^-d \rightarrow n \pi^+ \pi^- n$ final state.
%% For example, in the backward $\pi^-\Sigma^+$ case, the $d(K^-, n \pi^-)$ missing mass make $\Sigma^+$ peaks,
%% The background of $K^0$ and $\Sigma_{forward}$ production is determined by the fitting described below, whose contamination is included in this fitting.

%% The fitting to determine the amount of $K^0$ and $\Sigma_{forward}$ production is explained next.
%% Since this fitting is for estimating the $K^0$ and $\Sigma_{forward}$ production events,
%% the $K^0$ and $\Sigma_{forward}$ rejections are removed and all events in the $K^- d \rightarrow n \pi^+ \pi^- n$ final state are used.
%% This fitting uses $\pi^+\pi^-$, $n \pi^-$ and $n \pi^+$ invariant mass spectra,
%% in which make peaks for the $K^0$, $\Sigma^-$ and $\Sigma^+$ production reactions, respectively as shown in Figure.\ref{fig:fit_IM}.
%% In this fitting, the backward $\pi\Sigma$ production spectral shapes determined by the aforementioned fitting are fixed, and they provide a background that does not peak in any spectrum.

%% These fittings use different event samples to fix the intensities of each other, so they cannot be fitted simultaneously.
%% Therefore, these fittings are iteratively performed.

%% Since some of the $K^0$ production events were not 1-step reaction as described previous subsection, but 2-step reaction and direct $\Lambda(1520)$ production,
%% fitting is performed to estimate the proportion of these reactions.
%% The results provide background for the main signal, backward $\pi\Sigma$ production.
%% We then use them to obtain the $\pi^+\Sigma^-$ and $\pi^-\Sigma^+$ strength.

%% For fitting we need initial values, which we estimate from the area of the invariant mass distribution of $\pi^+\pi^-$, $n \pi^-$ and $n \pi^+$ fitted with a Gaussian.
%% They are then used to estimate the strength of backward $\pi\Sigma$ production.
%% The template fitting to estimate the background and the template fitting to estimate the strength of backward and $\pi\Sigma$ are then iterated 5 times.
%% Then we perform fitting to estimate 1-step, 2-step, and direct $\Lambda(1520)$ production in the event of $K^0$ production
%% to estimate the background for the template fitting to separate backward $\pi^-\Sigma^+$ and $\pi^+\Sigma^-$ modes.


%% And, we obtain the $\pi^- \Sigma^+$ and $\pi^+ \Sigma^-$ spectra performing the template fitting for $\pi^-\Sigma^+$ and $\pi^+ \Sigma^-$ separation as shown in Figure.\ref{fig:piS_num}.
%% These template fittings are performed by maximum likelihood using finite data and a much large but finite MC data sample.
%% Since the number of data is finite, simple comparison is not possible, but there is $-2\log\Lambda$ that asymptotically approaches $\chi^2$ when the number of data becomes infinite,
%% where $\Lambda$ is likelihood.
%% Template fitting for estimating the background of $K^0$ and $\Sigma_{forward}$ production gives $-2\log\Lambda$ as \IMfitChiSquare.
%% The NDF is the number of histogram bins that can be used for fitting minus the number of free parameters, \IMfitNDF, which is $-2\log\Lambda/$NDF$\sim$\IMfitChiNDF.
%% The likelihood of template fitting to separate $\pi^+\Sigma^-$ and $\pi^-\Sigma^+$ is shown in Figure.\ref{fig:tempFit_KNpi_Chi2}.
%% The result of the fitting is the separated spectrum as shown in Figure.\ref{fig:piS_num}.


